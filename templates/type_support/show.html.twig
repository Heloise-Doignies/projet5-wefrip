{% extends 'base.html.twig' %}

{% block title %}Les tutoriels par support - WeFrip'{% endblock %}

{% block body %}
<h1 class="text-center m-3">Support : {{ controller_name }}</h1>

{% if typesSupport is not empty %}
    {# On affiche toutes les vidéos de la catégorie avec une boucle #}
    <div class="row">

        {% for tutorial in typesSupport %}
            <div class="col-12 col-md-4 col-xl-4 mb-3">
                <div class="card h-100">
                    <div class="position-relative">
                        {% if tutorial.tutoSupportType is defined and tutorial.tutoImageName is not null %}
                            <img src="{{ asset('/img/imageTuto/' ~ tutorial.tutoImageName) }}" class="card-img-top images-tuto" alt="tutorial.tutoName">
                        {% else %}
                            <img src="{{ asset('/img/imageTuto/tuto-noimage.png') }}" class="card-img-top images-tuto" alt="image par défaut">
                        {% endif %}

                        {# Condition pour les favoris : si fav, bouton trash / si non fav, bouton heart #}
                        {% if is_granted('ROLE_USER')%}
                        {% if tutorial not in app.user.favoris %}
                        <a href="{{ path('add_favori', { id: tutorial.id }) }}" class="mt-3 btn btn-danger rounded-circle position-absolute bottom-0 end-0 p-1 m-2 text-light">
                            <i data-feather="heart"></i>
                        </a>
                        {% else %}
                        <a href="{{ path('remove_favori', { id: tutoFavoris.id }) }}" class="btn btn-dark rounded-circle position-absolute bottom-0 end-0 p-1 m-2 text-light">
                        <i data-feather="trash"></i>
                        </a>
                        {% endif %}
                        {% endif %}
                    </div>
                    <div class="card-body m-auto d-flex flex-column align-items-center justify-content-center">
                        <a href="{{ path('app_tutorial_show', { tutoSlug: tutorial.tutoSlug }) }}">
                            <h2 class="title-tuto">{{ tutorial.tutoName }}</h2>
                            <p>{{ tutorial.tutoDescription }}</p>
                        </a>
                        <div class="d-flex gap-3">
                            {# On affiche autant de boutons qu'il y a de catégorie(s) pour le tuto #}
                            {% for category in tutorial.categories %}
                                <a href="{{ path ('app_category_show', {categorySlug :category.categorySlug}) }}">
                                <button class="btn bouton">{{ category }}</button>
                                </a>
                            {% endfor %}
                            {# Bouton pour le type de support pour le tuto #}
                            <a href="{{ tutorial.tutoSupportType == 'Fiche' ? path('app_showFiche') : path('app_showVideo') }}">
                                <button class="btn bouton2">{{ tutorial.tutoSupportType }}</button>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

{% else %}

    <p class="text-center">Aucun tutoriel trouvé pour cette catégorie. </p>

{% endif %} 

<div class="d-flex justify-content-center mb-3">
    <a href="{{ path('app_type_support') }}" class="text-center">
        <button class="bouton btn mx-auto">Explorer les autres types de supports</button>
    </a>
</div>

{% endblock %}